### 全连接层

`tf.keras.layers.Dense(512)`，将512传给`Dense它会自动生成w1和bias。**(*这里有问题，我自己尝试不能完成自动创建*)**

```python
x = tf.random.normal([4, 748])

net = tf.keras.layers.Dense(512)
out = net(x)
out.shape
# TensorShape([4, 512]

net.kernel.shape, net.bias.shape  # kernel就是w， bias就是b
# (TensorShape([784, 512]), TensorShape([512]))
```

![](https://tva1.sinaimg.cn/large/006tNbRwly1gbfu1mymf6j31640iaqhc.jpg)

#### 手动创建w和b

通过`build`进行手动创建w和b

```python
In [21]: net = tf.keras.layers.Dense(10)  # 这个10表示kernel中的列和bias即输出的shape

In [22]: net.build(input_shape=(None, 4))  # 这个4表示kernel中的行，也就是输入值的shape，即batch

In [23]: net.kernel.shape, net.bias.shape
Out[23]: (TensorShape([4, 10]), TensorShape([10]))

In [24]: net.build(input_shape=(2, 4))

In [25]: net.kernel.shape, net.bias.shape
Out[25]: (TensorShape([4, 10]), TensorShape([10]))
```

**input_shape中的第一个参数暂时不知道其含义**

自己的理解：

首先需要有`tf.keras.layers.Dense(10)`创建一个全连接层，参数**10**表示需要从[b, x]$\Rightarrow$[b, 10]。然后需要使用`net.build(input_shape=(None, 20))`(假设`net=tf.keras.layers.Dense(10)`)建立kernel和bias，其中参数**20**表示输入数据列的维度，即[b, x] x的值大小。

[b, 20] $\Rightarrow$ [b, 10]

---

input_shape中None的含义目前不知道



#### Multi-Layers

如果要调用多层，使用`keras.Sequential([layer1, layer2, layer3,...])

![](https://tva1.sinaimg.cn/large/006tNbRwly1gbg5mhug8ej31ce0jak2k.jpg)

```python
x = tf.random.normal([2, 3])
model = keras.Sequential([
    keras.layers.Dense(2, activation='relu'),
    keras.layers.Dense(2, activation='relu'),
    keras.layers.Dense(2)
])
model.build(input_shape=(None, 3))
model.summary()

for p in  model.trainable_variables:
    print(p.name, p.shape)
    
# 输出
_________________________________________________________________
dense/kernel:0 (3, 2)  
dense/bias:0 (2,)   第一层
dense_1/kernel:0 (2, 2)
dense_1/bias:0 (2,)  第二层
dense_2/kernel:0 (2, 2)
dense_2/bias:0 (2,)  第三层
```

