## jinja2 模板

在flask中可以套用模板，首先在python文件下从flask中引用render_template，**from flask import render_template**，然后在本路径下创建一个templates文件（如果没有的话），在templates路径下创建html模板。最后在pyhon文件中使用即可。下面用一个简单的程序举例：

```python
# -*- coding: utf-8 -*-
from flask import Flask, render_template


app = Flask(__name__)


@app.route("/index")
def index():
    data = {
        "name": "python",
        "age": 18,
        "my_dice": {"city":"sz"},
        "my_list": [1, 2, 3, 4, 5],
        "my_int": 0

    }

    # 1. return render_template("index.html", name="python", age=18)
    return render_template("index.html", **data)

if __name__ == "__main__":
    app.run(debug=True)

```

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <p>name = {{ name }}</p>
    <p>age = {{ age }}</p>
    <p>my_dict: city= {{ my_dict["city"] }}</p>
    <p>my_dict: city= {{ my_dict.city }}</p>
    <p>my_list: {{ my_list }}</p>
    <p>my_list[my_int]: {{ my_list[my_init] }}</p>

</body>
</html>
```

在flask中一般是采用直接把需要传的参数写到render_template()中，但是也可以传字典，用**\**dict**方式将字典传入，**相当于直接将字典中的所有参数平铺在那里。

在模板中使用参数时，使用字典可以用python中的方法，**my_dict['']**的方式取出值，也可以使用**my_dict.key**的方式取出值。

在flask模板中，支持在html中进行数字和字符串的加法，{{my_list[0] + my_list[1] }}可以实现加法。同时也可以进行字符串的拼接。





## 字符串过滤器

- safe：禁用转义

  ```html
  <p>{{'<em>hello</em>' | safe}}</p>
  ```

- capitalize: 把变量值的首写字母转成大写，其余字母转小写

  ```html
  <p>{{'Hello'}} | capitalize</p>
  ```

- lower: 把值转成小写

  ```html
  <p>{{'HELLO' | lower }}<\p>
  ```

- upper: 把值转成大写

  ```html
  <p>{{'hello' | upper }}<\p>
  ```

- title: 把值中的每个单词的首写字母都转成大写

  ```
  <p>{{'hello' | title }}<\p>
  ```

- trim: 把值的首尾空格去掉

  ```html
  <p>{{'hello word' | trim }}<\p>
  ```

- reverse: 字符串反转

  ```html
  <p>{{'olleh' | reverse }}<\p>
  ```

- format: 格式化输出

  ```html
  <p>{{'%s is %d' | format("name", 17) }}<\p>
  ```

- striptags: 渲染之前把值中所有的HTML标签都删掉

  ```html
  <p>{{'<em>hello</em>' | striptags }}<\p>
  ```

**可以同时加多个过滤去**



## 支持链式使用过滤器

```
<p>{{‘hello word' | lower | trim }}<\p>
```



## 列表过滤器

- first: 取第一个元素

  ```
  <p>{{[1, 2, 3, 4, 5, 6,7]' | first }}</p>
  ```

- last: 取最后一个元素

  ```
  <p>{{[1, 2, 3, 4, 5, 6,7]' | last }}</p>
  ```

- length: 获取列表 长度

  ```
  <p>{{[1, 2, 3, 4, 5, 6, 7]' | length }}</p>
  ```

- sum: 列表求和

  ```
  <p>{{[1, 2, 3, 4, 5, 6, 7]' | sum }}</p>
  ```

- sort: 列表排序

  ```
  <p>{{[1, 2, 3, 4, 5, 6, 7]' | sort }}</p>
  ```



# 自定义过滤器

 自定义的过滤器名称如果和内置的过滤器重名，会覆盖内置的过滤器。

1. 通过 **add_template_filter(过滤器函数，模板中使用的过滤器名字)**

```python
def filter_double_sort(ls):
    return ls[::2]

app.add_template_filter(filter_double_sort, "double_2")
```

double_2是一个名字，在html文件中使用的过滤器名字

2. 通过装饰器 **app.template_filter(模板中使用的装饰器名字)**

```python
@app.template_filter('db3')
def filter_double_sort(ls):
    return ls[::-3]
```

db3也是一个过滤器名字 

  